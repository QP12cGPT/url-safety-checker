# URL Safety Checker

このプロジェクトは、WebサイトやURLの安全性を簡単にチェックするためのPythonスクリプトです。
Google Safe Browsing APIと独自の基本的な検査機能を組み合わせています。

## 機能
- 軽量版 (`url_guard.py`): Google Safe Browsingや簡易ドメイン検査
- 挙動観測版 (`behavior_check.py`): HTTPヘッダーや挙動の確認

## 必要なもの
- Python 3.8以上
- Google Safe Browsing APIキー（`.env`に `GSB_API_KEY=...` を設定）

## インストール
```bash
pip install -r requirements.txt
```

## 使用例
```bash
python url_guard.py https://example.com
python behavior_check.py https://example.com
```

## 注意事項
- 本ツールは100%の安全性を保証するものではありません。
- 判定は参考情報として使用し、最終的な判断は自己責任で行ってください。

- ⚠️ このツールができること / できないこと
できること：任意のURLを手動で指定して、危険性のヒントを出す

軽量版：GSB・DNS/TLS・簡易ヒューリスティクス

挙動観測版：ページアクセス中の送信先・POST内容の要約を記録し、PSP以外へのPII送信を警告

できないこと：

メールの受信トレイを自動で監視したり、届いたメール内のリンクを自動で判定すること（現状は未対応）

端末側マルウェア/悪質拡張の検知、偽アプリの自動判定、オーバーレイ偽フォームの完全検知

つまり、自動の“フィッシングメール検出器”ではありません。
本ツールは「気になるURLを自分で投げて調べる」ためのプロトタイプです。

🧪 プロトタイプです（自由に改造してください）
このリポジトリは参考実装です。
利用環境・ポリシーに合わせて、以下のような拡張を自由に行ってください：

メールクライアントやゲートウェイと連携してURLを自動投入（IMAP/Graph API などの統合）

PSP_ALLOW / PII_KEYS / THIRD_PARTY_SOFT_ALLOW の社内基準への最適化

レポートをSlack/Teamsへ通知、SIEMへ連携、CIでのURLスキャンなど

📝 スマホ新法についての補足（影響タイミング）
スマホ新法の全面施行は 2025年12月18日です。ただし、市場やアプリに実際の影響が及ぶタイミングは段階的になる可能性があります（OSの対応、ストア側・事業者側の準備期間等）。
→ 本ツールは、その「移行期」に自己防衛の初手として使う想定です。

🙏 免責・お願い
本ツールは安全を保証するものではありません。判定はあくまで参考情報です。

倫理/法令を遵守し、テストはダミーデータで行ってください。

Issue/PR歓迎。改善点や誤検知の報告が品質向上につながります。
